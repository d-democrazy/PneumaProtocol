%%{init: {
  'theme': 'base',
  'themeVariables': {
    'primaryColor': '#1e3a8a',
    'primaryTextColor': '#ffffff',
    'primaryBorderColor': '#3b82f6',
    'lineColor': '#6366f1',
    'sectionBkgColor': '#f8fafc',
    'altSectionBkgColor': '#e2e8f0',
    'gridColor': '#cbd5e1',
    'secondaryColor': '#7c3aed',
    'tertiaryColor': '#059669',
    'background': '#ffffff',
    'mainBkg': '#ffffff',
    'secondBkg': '#f1f5f9',
    'tertiaryBkg': '#ecfdf5'
  },
  'flowchart': {
    'nodeSpacing': 50,
    'rankSpacing': 60,
    'curve': 'basis',
    'padding': 20
  }
}}%%

graph TD
    %% Network Activity Layer
    A["ğŸŒ Blockchain Network Activity"] --> B["âš¡ Transaction Processing"]
    B --> C["ğŸ’° Gas Fee Collection"]
    C --> D{"ğŸ”„ Transaction Type"}
    
    D --> E["ğŸ“Š TxnFeePaid<br/>âš–ï¸ Weight: 1.0"]
    D --> F["ğŸ“ˆ TxnFeeInvolved<br/>âš–ï¸ Weight: 0.25"]
    
    %% Score Calculation Layer
    E --> G["ğŸ‘¤ Individual Wallet<br/>Score Calculation"]
    F --> G
    F --> H["ğŸ“‹ Contract Score<br/>Calculation"]
    
    G --> I["ğŸ§® Score = TxnFeePaid +<br/>0.25 Ã— TxnFeeInvolved"]
    H --> J["ğŸ“Š RawScore =<br/>TxnFeeInvolved Ã— 0.25"]
    
    %% Collateralization System
    K["ğŸª™ PNEUMA Token Supply<br/>ğŸ“¦ 2.1B Fixed"] --> L["ğŸ”’ Collateralization Pool"]
    L --> M["ğŸ” Lock Function<br/>lockFor(contract, amount)"]
    M --> N["ğŸ“ Collateralization Ratio<br/>r = P_c / S_PNEUMA"]
    
    N --> O["ğŸ“ˆ Weight Amplification<br/>W_c = 0.25 + r_c Ã— 0.75"]
    O --> P["ğŸš€ Amplified Score<br/>AmplifiedScore = TxnFeeInvolved Ã— W_c"]
    
    J --> P
    
    %% Cumulative Scoring
    I --> Q["ğŸ“ˆ Cumulative Lifetime Score"]
    P --> R["ğŸ“Š Cumulative Contract Score"]
    
    Q --> S["âˆ‘ CumulativeScore_j,i =<br/>Sum from k=1 to i Score_j,k"]
    R --> T["âˆ‘ CumulativeScore_c,i =<br/>Sum from k=1 to i AmplifiedScore_c,k"]
    
    %% Epoch System
    U["â° 25 Epochs Ã— 4 Years Each<br/>ğŸ• 100 Year Cycle"] --> V["ğŸ“‰ Deflationary Allocation"]
    V --> W["ğŸ¯ S_1 = 226M PNEUMA<br/>ğŸ“‰ S_i = S_1 Ã— 0.9^(i-1)"]
    
    %% Reward Distribution
    S --> X["ğŸŒ Network Total<br/>Cumulative Score"]
    X --> Y["ğŸ Reward Calculation"]
    W --> Y
    Y --> Z["ğŸ’ Reward_j,i =<br/>CumulativeScore_j,i / NetworkTotal Ã— S_i"]
    
    %% Token Valuation
    T --> AA["ğŸ’° Token Valuation"]
    AA --> BB["ğŸ“Š V_t,i = CumulativeScore_c,i"]
    BB --> CC["ğŸ·ï¸ Per-Token Value<br/>V_per-token = V_t,i / S_t"]
    
    %% Exchange System
    CC --> DD["ğŸ’± Token Exchange Rates"]
    DD --> EE["âš–ï¸ Rate_Aâ†’B = V_A / V_B"]
    
    %% Constraints
    FF["âš ï¸ Ecosystem Constraints"] --> GG["ğŸ”’ Sum V_t,i â‰¤ 2.1B PNEUMA"]
    BB --> GG
    
    %% LaunchPad Integration
    HH["ğŸš€ LaunchPad Platform"] --> II["ğŸ“ Token Registration"]
    HH --> JJ["ğŸ›¡ï¸ Collateral Management"]
    HH --> KK["ğŸ“Š Valuation Monitoring"]
    
    II --> M
    JJ --> L
    KK --> BB
    
    %% Time Flow
    LL["â³ Time Progression"] --> MM["ğŸ”„ Epoch Transition"]
    MM --> NN["ğŸ“Š Score Reset: âŒ<br/>Cumulative: âœ…"]
    MM --> OO["ğŸ§® New Allocation<br/>Calculation"]
    
    NN --> Q
    NN --> R
    OO --> W
    
    %% Value Growth Dynamics
    PP["ğŸ“ˆ Growth Mechanisms"] --> QQ["ğŸ”¥ Utility Growth<br/>â†‘ Contract Activity"]
    PP --> RR["ğŸ’ Collateral Growth<br/>â†‘ PNEUMA Locked"]
    
    QQ --> H
    RR --> N
    
    %% Enhanced Styling
    classDef networkLayer fill:#dbeafe,stroke:#3b82f6,stroke-width:3px,color:#1e40af,font-weight:bold
    classDef rewardSystem fill:#dcfce7,stroke:#22c55e,stroke-width:2px,color:#166534,font-weight:bold
    classDef valuationSystem fill:#fce7f3,stroke:#ec4899,stroke-width:2px,color:#be185d,font-weight:bold
    classDef collateralization fill:#fed7aa,stroke:#f97316,stroke-width:2px,color:#c2410c,font-weight:bold
    classDef epochSystem fill:#e0e7ff,stroke:#6366f1,stroke-width:2px,color:#4338ca,font-weight:bold
    classDef constraints fill:#fecaca,stroke:#ef4444,stroke-width:3px,color:#dc2626,font-weight:bold
    classDef launchpad fill:#f3e8ff,stroke:#a855f7,stroke-width:2px,color:#7c2d12,font-weight:bold
    classDef calculation fill:#fef3c7,stroke:#f59e0b,stroke-width:2px,color:#d97706,font-weight:bold
    classDef growth fill:#ccfbf1,stroke:#14b8a6,stroke-width:2px,color:#0f766e,font-weight:bold
    
    class A,B,C,D networkLayer
    class E,F,G,H,I,J,Q,R,S,T,X,Y,Z rewardSystem
    class AA,BB,CC,DD,EE valuationSystem
    class K,L,M,N,O,P collateralization
    class U,V,W,LL,MM,NN,OO epochSystem
    class FF,GG constraints
    class HH,II,JJ,KK launchpad
    class PP,QQ,RR growth